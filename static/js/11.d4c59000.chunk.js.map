{"version":3,"sources":["components/recentHighlight/index.tsx"],"names":["buildEventInfo","cellData","event","fan","役满","sum","map","x","count","length","label","slice","FanStatEntryList","formatFanSummary","COLUMN_EVENTINFO","makeColumn","dataKey","cellRenderer","width","getEventPlayerId","rec","player","RecentHighlight","provider","useMemo","DataProvider","createHightlight","title","withActivePlayer","alwaysShowDetailLink","columns","COLUMN_GAMEMODE","COLUMN_PLAYERS","COLUMN_FULLTIME"],"mappings":"mHAAA,0HAwBA,SAASA,EAAT,GAAuD,IAA7BC,EAA4B,EAA5BA,SACxB,IAAKA,EACH,OAAO,KAET,IAAMC,EAAQD,EACd,IAAKC,EAAMC,IAAI,GAAGC,aAChB,OACE,8BACGC,YAAIH,EAAMC,IAAIG,KAAI,SAAAC,GAAC,OAAIA,EAAEC,UAD5B,UAEE,6BAFF,4BAOJ,GAAyB,IAArBN,EAAMC,IAAIM,OAAc,CAC1B,IAAMC,EAAQR,EAAMC,IAAI,GAAGO,MAC3B,OAAIA,EAAMD,OAAS,EAEf,8BACGC,EAAMC,MAAM,EAAG,GAChB,6BACCD,EAAMC,MAAM,IAIZD,EACF,OAAyB,IAArBR,EAAMC,IAAIM,OAEjB,8BACGP,EAAMC,IAAI,GAAGO,MACd,6BACCR,EAAMC,IAAI,GAAGO,OAIb,8BAAOE,mBAAiBC,iBAAiBX,EAAMC,MAGxD,IAAMW,EAAmBC,aAAW,kBAClC,kBAAC,IAAD,CAAQC,QAAQ,QAAQN,MAAM,eAAKO,aAAcjB,EAAgBkB,MAAO,OADjDH,GAIzB,SAASI,EAAiBC,GACxB,OAAQA,EAA4BlB,MAAMmB,OAG7B,SAASC,IACtB,IAAMC,EAAWC,mBAAQ,kBAAMC,IAAaC,qBAAoB,IAChE,OACE,oCACE,kBAAC,IAAD,CAAQC,MAAM,6BACd,kBAAC,IAAD,CAA2BJ,SAAUA,GACnC,kBAAC,IAAD,CACEK,kBAAgB,EAChBC,sBAAoB,EACpBC,QAAS,CAACC,IAAiBjB,EAAkBkB,YAAeb,GAAmBc","file":"static/js/11.d4c59000.chunk.js","sourcesContent":["import React, { useMemo } from \"react\";\nimport Helmet from \"react-helmet\";\nimport { DataProvider } from \"../../data/source/records/provider\";\nimport { DataAdapterProviderCustom } from \"../gameRecords/dataAdapterProvider\";\nimport GameRecordTable, {\n  COLUMN_GAMEMODE,\n  COLUMN_PLAYERS,\n  COLUMN_FULLTIME,\n  makeColumn,\n  Column\n} from \"../gameRecords/table\";\nimport { GameRecord, FanStatEntryList } from \"../../data/types\";\nimport { TableCellProps } from \"react-virtualized/dist/es/Table\";\nimport { sum } from \"../../utils\";\n\ntype Event = {\n  type: \"役满\";\n  fan: FanStatEntryList;\n  player: number;\n};\ntype GameRecordWithEvent = GameRecord & {\n  event: Event;\n};\n\nfunction buildEventInfo({ cellData }: TableCellProps) {\n  if (!cellData) {\n    return null;\n  }\n  const event = cellData as Event;\n  if (!event.fan[0].役满) {\n    return (\n      <span>\n        {sum(event.fan.map(x => x.count))} 番\n        <br />\n        累计役满\n      </span>\n    );\n  }\n  if (event.fan.length === 1) {\n    const label = event.fan[0].label;\n    if (label.length > 4) {\n      return (\n        <span>\n          {label.slice(0, 4)}\n          <br />\n          {label.slice(4)}\n        </span>\n      );\n    }\n    return label;\n  } else if (event.fan.length === 2) {\n    return (\n      <span>\n        {event.fan[0].label}\n        <br />\n        {event.fan[1].label}\n      </span>\n    );\n  }\n  return <span>{FanStatEntryList.formatFanSummary(event.fan)}</span>;\n}\n\nconst COLUMN_EVENTINFO = makeColumn(() => (\n  <Column dataKey=\"event\" label=\"类型\" cellRenderer={buildEventInfo} width={80} />\n))();\n\nfunction getEventPlayerId(rec: GameRecord) {\n  return (rec as GameRecordWithEvent).event.player;\n}\n\nexport default function RecentHighlight() {\n  const provider = useMemo(() => DataProvider.createHightlight(), []);\n  return (\n    <>\n      <Helmet title=\"最近役满\" />\n      <DataAdapterProviderCustom provider={provider}>\n        <GameRecordTable\n          withActivePlayer\n          alwaysShowDetailLink\n          columns={[COLUMN_GAMEMODE, COLUMN_EVENTINFO, COLUMN_PLAYERS(getEventPlayerId), COLUMN_FULLTIME]}\n        />\n      </DataAdapterProviderCustom>\n    </>\n  );\n}\n"],"sourceRoot":""}