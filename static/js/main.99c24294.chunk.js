(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){e.exports=n(184)},115:function(e,t,n){},184:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(28),c=(n(111),n(113),n(115),n(74)),l=n(11),u=n(26),o=r.a.createContext({}),s=function(){return Object(a.useContext)(o)};var d=function(e){var t=e.children;return r.a.createElement(u.d,null,function(e){return r.a.createElement(o.Provider,{value:e},t)})},h=function(e){var t=e.title,n=void 0===t?void 0:t,a=e.children,i=void 0===a?void 0:a,c=e.fluid,l=void 0!==c&&c;return r.a.createElement("div",{className:"my-5 container".concat(l?"-fluid":"")},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},n&&r.a.createElement("h2",{className:"mb-4"},n),i)))},f=n(17);function m(e){var t=e.className,n=void 0===t?"":t,i=e.type,c=void 0===i?"info":i,l=e.container,u=void 0===l?r.a.Fragment:l,o=e.stateName,s=void 0===o?"":o,d=e.children,h=void 0===d?void 0:d,m="alertState_".concat(s),v=Object(a.useState)(function(){return s&&!!localStorage.getItem(m)}),p=Object(f.a)(v,2),b=p[0],k=p[1];if(Object(a.useEffect)(function(){s&&b&&localStorage.setItem(m,"true")},[b,s,m]),b)return null;var _=u;return r.a.createElement(_,null,r.a.createElement("div",{className:"alert alert-".concat(c," alert-dismissible fade show ").concat(n),role:"alert"},h,r.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(e){e.preventDefault(),k(!0),setTimeout(function(){window.dispatchEvent(new UIEvent("resize"))},1e3)}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))))}function v(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null,r.a.createElement("h1",null,"\u96c0\u9b42\u724c\u8c31\u5c4b")),r.a.createElement(m,{container:h,stateName:"topNote"},r.a.createElement("h4",null,"\u8bf4\u660e"),r.a.createElement("ul",null,r.a.createElement("li",null,"\u672c\u9875\u9762\u7531\u7b2c\u4e09\u65b9\u7ef4\u62a4\uff0c\u4e0e\u96c0\u9b42\u5b98\u65b9\u65e0\u5173\u3002"),r.a.createElement("li",null,"\u8bb0\u5f55\u5305\u542b\u96c0\u9b42\u56fd\u670d\u56db\u4eba\u534a\u5e84\u6bb5\u4f4d\u6218\u7389\u4e4b\u95f4\u53ca\u738b\u5ea7\u4e4b\u95f4\u7684\u724c\u8c31\u3002"),r.a.createElement("li",null,"\u6b63\u5e38\u60c5\u51b5\u4e0b\u5168\u90e8\u5bf9\u5c40\u90fd\u4f1a\u88ab\u8bb0\u5f55\uff0c\u4f46\u4e0d\u6392\u9664\u56e0\u7f51\u7edc\u95ee\u9898\u9057\u6f0f\u90e8\u5206\u5bf9\u5c40\u7684\u60c5\u51b5\u3002\u53e6 2019 \u5e74 10 \u6708 10 \u65e5\u524d\u56e0\u7a0b\u5e8f Bug \u6bcf\u5929\u665a\u95f4\u53ef\u80fd\u9057\u6f0f\u6389 10% ~ 20% \u7684\u5bf9\u5c40\uff0c\u6b64 Bug \u76ee\u524d\u5df2\u7ecf\u4fee\u590d\u3002"),r.a.createElement("li",null,"\u9875\u9762\u4e0d\u662f\u5b9e\u65f6\u66f4\u65b0\uff0c\u5bf9\u5c40\u4e00\u822c\u4f1a\u5728\u7ed3\u675f\u540e\u4e8c\u5341\u5206\u949f\u5185\u51fa\u73b0\u3002"),r.a.createElement("li",null,"\u5982\u6709\u95ee\u9898\u6216\u5efa\u8bae\uff0c\u8bf7\u6233 ",r.a.createElement("a",{href:"mailto:i@sapika.ch"},"SAPikachu (i@sapika.ch)")," \u6216"," ",r.a.createElement("a",{href:"https://github.com/SAPikachu/amae-koromo/"},"\u63d0\u4ea4 Issue"),"\u3002"))))}var p,b=n(75),k=n(8),_=n.n(k);!function(e){e[e["\u738b\u5ea7"]=16]="\u738b\u5ea7",e[e["\u7389"]=12]="\u7389"}(p||(p={}));var g=p,y=Object.keys(p).filter(function(e){return"number"===typeof p[e]}).length,E=Object.freeze({toPlain:function(e){return{date:e.date?_()(e.date).valueOf():null,searchText:e.searchText,selectedModes:e.selectedModes?Array.from(e.selectedModes):null,version:e.version}},fromPlain:function(e){return{date:e.date||null,searchText:e.searchText||"",selectedModes:e.selectedModes?new Set(e.selectedModes):null}}}),C={date:null,selectedModes:null,searchText:"",version:0},O=r.a.createContext([C,function(){}]),M=function(){return Object(a.useContext)(O)};function j(e,t){if(void 0!==t.date&&t.date!==e.date&&(!t.date||!e.date||!_()(t.date).isSame(e.date,"day")))return!0;if(void 0!==t.searchText&&t.searchText!==e.searchText)return!0;var n=t.selectedModes;if(n&&n.size>=y&&(n=null),void 0!==n&&n!==e.selectedModes){if(!n||!e.selectedModes)return!0;if(function(e,t){if(e.size!==t.size)return!1;var n=!0,a=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var l=i.value;if(!e.has(l))return!1}}catch(u){a=!0,r=u}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}return!0}(e.selectedModes,n))return!0}return!1}function w(e){var t=e.children,n=Object(l.h)(),i=Object(a.useReducer)(function(e,t){return j(e,t)?Object(b.a)({},e,function(e){return e.date&&(e.date=_()(e.date).valueOf()),e.selectedModes&&e.selectedModes.size>=y&&(e.selectedModes=null),e}(t),{version:e.version+1}):e},null,function(){return Object(b.a)({},C,E.fromPlain((n.state||{}).model||{}),{version:0})}),c=Object(f.a)(i,2),u=c[0],o=c[1],s=Object(a.useMemo)(function(){return[u,o]},[u,o]);return r.a.createElement(O.Provider,{value:s},t)}function x(){var e=Object(l.i)(),t=M(),n=Object(f.a)(t,2),a=n[0],i=n[1],c=Object(l.h)(),u=c.state;if(u&&u.model.version===a.version)return r.a.createElement(r.a.Fragment,null);if(!u){var o=e.date?_()(e.date,"YYYY-MM-DD"):null;if(o&&!o.isValid())return r.a.createElement(l.a,{to:"/"});var s=e.modes?new Set(e.modes.split(".").map(function(e){return e.trim()}).filter(function(e){return!!e})):null,d={date:o?o.startOf("day").valueOf():null,selectedModes:s,searchText:e.search||"",version:a.version};return i(d),r.a.createElement(l.a,{to:{pathname:c.pathname,state:{path:c.pathname,model:E.toPlain(d)}}})}var h=function(e){if((!e.selectedModes||!e.selectedModes.size)&&!e.searchText&&!e.date)return"/";return Object(l.f)(le,{date:_()(e.date||new Date).format("YYYY-MM-DD"),modes:e.selectedModes&&e.selectedModes.size?Array.from(e.selectedModes).join("."):void 0,search:e.searchText||void 0})}(a);return h===u.path?r.a.createElement(r.a.Fragment,null):r.a.createElement(l.a,{to:{pathname:h,state:{path:h,model:E.toPlain(a)}}})}var I=n(54),P=n(44),S=n(45),N=n(16),T=n.n(N),Y=n(33),D="https://d2ek5tscv4zquv.cloudfront.net/",R="".concat(D,"api/"),U="\u521d\u58eb\u6770\u8c6a\u5723\u9b42";var F=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;Object(P.a)(this,e),this._date=void 0,this._count=void 0,this._chunks=void 0,this._itemsPerChunk=void 0,this._filterPredicate=void 0,this._filteredIndices=void 0,this._filterResultCache=void 0,this._date=_()(t).startOf("day"),this._count=null,this._chunks=[],this._itemsPerChunk=n,this._filterPredicate=null,this._filteredIndices=null,this._filterResultCache={}}return Object(S.a)(e,[{key:"_apiGet",value:function(){var e=Object(Y.a)(T.a.mark(function e(t){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(R+t);case 2:if((n=e.sent).ok){e.next=5;break}throw n;case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"setFilterPredicate",value:function(e){this._filterPredicate!==e&&(this._filterPredicate=e,this._filterResultCache={},this.updateFilteredIndices())}},{key:"updateFilteredIndices",value:function(){if(this._filteredIndices=null,this._filterPredicate){var e=this._count;if("number"===typeof e){for(var t=0,n=0,a=[],r=0;r<e;r++){var i=this._chunks[Math.floor(r/this._itemsPerChunk)];if(!i||i instanceof Promise)a.push(r);else{n++;var c=i[r%this._itemsPerChunk],l=this._filterResultCache[c.uuid];void 0===l&&(this._filterResultCache[c.uuid]=l=this._filterPredicate(c)),l&&(a.push(r),t++)}}this._filteredIndices=a,t<10&&n>=this._itemsPerChunk&&this._triggerFullLoad()}}}},{key:"getCountMaybeSync",value:function(){return null===this._count?this.getCount():this._filteredIndices?this._filteredIndices.length:this._count}},{key:"getCount",value:function(){var e=Object(Y.a)(T.a.mark(function e(){var t=this;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===this._count&&(this._count=Object(Y.a)(T.a.mark(function e(){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._apiGet("count/".concat(t._date.valueOf()));case 2:return n=e.sent,t._count=n.count,t.updateFilteredIndices(),e.abrupt("return",t.getCountMaybeSync());case 6:case"end":return e.stop()}},e)}))()),e.abrupt("return",this.getCountMaybeSync());case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getUnfilteredCountSync",value:function(){return"number"!==typeof this._count?null:this._count}},{key:"isItemLoaded",value:function(e){var t=this._mapItemIndex(e);if(null===t)return!1;var n=Math.floor(t/this._itemsPerChunk);return!!this._chunks[n]&&!(this._chunks[n]instanceof Promise)}},{key:"getItem",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this._mapItemIndex(e);if(null===a)return this.getCount().then(function(){return t.getItem(e)});var r=Math.floor(a/this._itemsPerChunk),i=a%this._itemsPerChunk,c=this._chunks[r];return!c||c instanceof Promise?this._getChunk(r).then(function(e){return e[i]}):(n||this._filteredIndices||this.preload(e+this._itemsPerChunk),c[i])}},{key:"preload",value:function(e){var t=this.getCountMaybeSync();t instanceof Promise||e>=t||this.getItem(e,!0)}},{key:"_mapItemIndex",value:function(e){var t=this.getCountMaybeSync();if(t instanceof Promise)return null;if(e<0)return null;var n=t-e-1;return n<0?null:this._filteredIndices?this._filteredIndices[n]:n}},{key:"_getChunk",value:function(){var e=Object(Y.a)(T.a.mark(function e(t){return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._chunks[t]||(this._chunks[t]=this._loadChunk(t)),e.abrupt("return",this._chunks[t]);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_triggerFullLoad",value:function(){var e=this.getCountMaybeSync();if("number"===typeof e)for(var t=Math.ceil(e/this._itemsPerChunk),n=0;n<t;n++)this._chunks[n]||this._getChunk(n)}},{key:"_loadChunk",value:function(){var e=Object(Y.a)(T.a.mark(function e(t){var n,a,r;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCount();case 2:if(n=e.sent,a=Math.ceil(n/this._itemsPerChunk)){e.next=6;break}return e.abrupt("return",[]);case 6:if(!(t>=a)){e.next=9;break}return console.warn("Loading out-of-index chunk: ".concat(t,", number of items: ").concat(this._count)),e.abrupt("return",[]);case 9:return e.next=11,this._apiGet("games/".concat(this._date.valueOf(),"?skip=").concat(this._itemsPerChunk*t,"&limit=").concat(this._itemsPerChunk,"&tag=").concat(t===a-1?n:""));case 11:return(r=e.sent).length<this._itemsPerChunk&&t<a-1&&console.warn("Unexpected number of items in chunk:",r.length),this._chunks[t]=r,this.updateFilteredIndices(),e.abrupt("return",r);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),H=function(e){return _()(e).startOf("day").valueOf().toString()},z={loading:!0},L=new(function(){function e(){Object(P.a)(this,e)}return Object(S.a)(e,[{key:"getCount",value:function(){return 0}},{key:"getUnfilteredCount",value:function(){return 0}},{key:"getItem",value:function(e){return z}},{key:"isItemLoaded",value:function(e){return!1}}]),e}()),G=function(){},K=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;Object(P.a)(this,e),this._provider=void 0,this._onDataUpdate=void 0,this._triggeredRequest=void 0,this._provider=t,this._onDataUpdate=n,this._triggeredRequest=!1}return Object(S.a)(e,[{key:"_installHook",value:function(e){this._triggeredRequest||(this._triggeredRequest=!0,e.then(this._callHook.bind(this)))}},{key:"_callHook",value:function(){this._onDataUpdate()}},{key:"getCount",value:function(){var e=this._provider.getCountMaybeSync();return e instanceof Promise?(this._installHook(e),0):e}},{key:"getUnfilteredCount",value:function(){return this._provider.getUnfilteredCountSync()||0}},{key:"getItem",value:function(e){return this._provider.isItemLoaded(e)?this._provider.getItem(e):(this._triggeredRequest||this._installHook(this._provider.getItem(e)),z)}},{key:"isItemLoaded",value:function(e){return!(e<0)&&this._provider.isItemLoaded(e)}},{key:"setUpdateHook",value:function(e){this._onDataUpdate=e}},{key:"cancelUpdateHook",value:function(){this._onDataUpdate=G}}]),e}(),q=r.a.createContext(L),A=function(){return Object(a.useContext)(q)};q.Consumer;function B(e){var t=e.children,n=M(),i=Object(f.a)(n,1)[0],c=i.date||_()(),l=Object(a.useState)(function(){return Object(I.a)({},H(c),new F(c))}),u=Object(f.a)(l,1)[0],o=(i.searchText||"").trim(),s=Object(a.useMemo)(function(){return o||i.selectedModes&&i.selectedModes.size<y?function(e){return!(i.selectedModes&&!i.selectedModes.has(e.modeId.toString()))&&!(o&&!e.players.some(function(e){return e.nickname.toLowerCase().indexOf(o)>-1}))}:null},[i.selectedModes,o]),d=Object(a.useMemo)(function(){var e=H(c);return u[e]||(u[e]=new F(c)),u[e]},[c,u]),h=Object(a.useState)(function(){return L}),m=Object(f.a)(h,2),v=m[0],p=m[1],b=Object(a.useCallback)(function(){d.setFilterPredicate(s);var e=new K(d);p(e)},[d,s]);return Object(a.useEffect)(b,[b]),Object(a.useEffect)(function(){var e=v;if(e instanceof K)return function(){return e.cancelUpdateHook()}},[v]),Object(a.useEffect)(function(){v instanceof K&&v.setUpdateHook(b)},[v,b]),r.a.createElement(q.Provider,{value:v},t)}var J=n(105),V=n(10);var Q=function(e){var t,n=e.player,a=n.nickname,i=n.level,c=n.score,l=n.accountId,u=e.game.uuid,o=e.isTop;return r.a.createElement("div",{className:"player ".concat(o&&"font-weight-bold")},r.a.createElement("a",{href:"https://www.majsoul.com/1/?paipu=".concat(u,"_a").concat((t=l,1358437+(7*t+1117113^86216345))),target:"_blank"},"[",function(e){var t=e%1e4,n=Math.floor(t/100),a=t%100,r=U[n-1];return n===U.length?r:r+a}(i),"] ",a," ",void 0!==c&&"[".concat(c,"]")))},W=r.a.memo(function(e){var t=e.game;return r.a.createElement("div",{className:"row no-gutters"},t.players.map(function(e){return r.a.createElement("div",{key:e.accountId,className:"col-12 col-md-6 pr-1"},r.a.createElement(Q,{game:t,player:e,isTop:e.score===Math.max.apply(Math,Object(J.a)(t.players.map(function(e){return e.score})))}))}))}),X=function(e){var t,n=e.cellData;return(t=n)?_.a.unix(t).format("HH:mm"):null},Z=function(e){var t=e.cellData;return g[t]},$=function(e){var t=e.rowData;return t&&t.players?r.a.createElement(W,{game:t}):null};function ee(){var e=A(),t=s(),n=t.isScrolling,i=t.onChildScroll,c=t.scrollTop,l=t.height,o=Object(a.useCallback)(function(t){var n=t.index;return e.getItem(n)},[e]),d=Object(a.useCallback)(function(t){var n=t.index;return n>=0?Object(V.a)({loading:!e.isItemLoaded(n),even:0===(1&n)}):""},[e]),h=Object(a.useCallback)(function(){return e.getUnfilteredCount()?null:r.a.createElement("p",{className:"text-center"},"\u52a0\u8f7d\u4e2d...")},[e]);return r.a.createElement("div",{ref:t.registerChild},r.a.createElement(u.a,{disableHeight:!0},function(t){var a=t.width;return r.a.createElement(u.c,{autoHeight:!0,rowCount:e.getCount(),rowGetter:o,rowHeight:window.matchMedia("(min-width: 768px)").matches?70:140,headerHeight:50,width:a,height:l,isScrolling:n,onScroll:i,scrollTop:c,rowClassName:d,noRowsRenderer:h},r.a.createElement(u.b,{dataKey:"modeId",label:"\u7b49\u7ea7",cellRenderer:Z,width:40}),r.a.createElement(u.b,{dataKey:"players",label:"\u73a9\u5bb6",cellRenderer:$,width:120,flexGrow:1}),r.a.createElement(u.b,{dataKey:"startTime",label:"\u5f00\u59cb",cellRenderer:X,width:40}),r.a.createElement(u.b,{dataKey:"endTime",label:"\u7ed3\u675f",cellRenderer:X,width:40}))}))}function te(e){var t=e.items,n=void 0===t?[]:t,a=e.selectedItemKeys,i=void 0===a?null:a,c=e.groupKey,l=void 0===c?"default":c,u=e.onChange,o=void 0===u?function(e){}:u,s=function(e,t){if((!t||i&&!i.has(e))&&(t||!i||i.has(e))){var a=new Set(i||n.map(function(e){return e.key}));t?a.add(e):a.delete(e),o(a)}};return r.a.createElement(r.a.Fragment,null,n.map(function(e){return r.a.createElement("div",{className:"form-check form-check-inline",key:e.key},r.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"CG_".concat(l,"_").concat(e.key),value:e.key,checked:!i||i.has(e.key),onChange:function(t){return s(e.key,t.currentTarget.checked)}}),r.a.createElement("label",{className:"form-check-label",htmlFor:"CG_".concat(l,"_").concat(e.key)},e.label))}))}function ne(e){var t=e.date,n=void 0===t?_()():t,i=e.onChange,c=void 0===i?function(e){}:i,l=e.className,u=void 0===l?"":l,o=e.min,s=void 0===o?void 0:o,d=e.max,h=void 0===d?_()():d,f=Object(a.useCallback)(function(e){return c(_()(e.currentTarget.value,"YYYY-MM-DD"))},[c]);return r.a.createElement("input",{className:u,type:"date",value:_()(n).format("YYYY-MM-DD"),min:s?_()(s).format("YYYY-MM-DD"):void 0,max:h?_()(h).format("YYYY-MM-DD"):void 0,onChange:f})}var ae=function(e){var t=e.title,n=void 0===t?"":t,a=e.children,i=void 0===a?void 0:a;return r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},n),r.a.createElement("div",{className:"col-sm-10"},i))},re=Object.keys(g).filter(function(e){return"string"!==typeof g[e]}).map(function(e){return{key:String(g[e]),label:e}}),ie=_()().startOf("day");function ce(){var e=M(),t=Object(f.a)(e,2),n=t[0],i=t[1],c=Object(a.useCallback)(function(e){return i({searchText:e.currentTarget.value})},[i]),l=Object(a.useCallback)(function(e){return i({selectedModes:e})},[i]),u=Object(a.useCallback)(function(e){return i({date:e})},[i]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,{title:"\u65e5\u671f"},r.a.createElement(ne,{min:"2019-08-23",date:n.date||ie,onChange:u,className:"form-control"})),r.a.createElement(ae,{title:"\u67e5\u627e\u73a9\u5bb6"},r.a.createElement("input",{type:"text",className:"form-control",value:n.searchText,onChange:c})),r.a.createElement(ae,null,r.a.createElement(te,{items:re,selectedItemKeys:n.selectedModes,onChange:l})))}var le="/:date(\\d{4}-\\d{2}-\\d{2})/:modes([0-9.]+)?/:search?";var ue=function(){return r.a.createElement(w,null,r.a.createElement(x,null),r.a.createElement(ce,null),r.a.createElement(B,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:["/",le]},r.a.createElement(ee,null)),r.a.createElement(l.b,null,r.a.createElement(l.a,{to:"/"})))))};var oe=function(){return r.a.createElement(c.a,null,r.a.createElement(d,null,r.a.createElement(v,null),r.a.createElement(h,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:["/","/:date(\\d{4}-\\d{2}-\\d{2})/:modes([0-9.]+)?/:search?"]},r.a.createElement(ue,null)),r.a.createElement(l.b,null,r.a.createElement(l.a,{to:"/"}))))))},se=document.getElementById("root");Object(i.render)(a.createElement(oe,null),se)}},[[106,2,1]]]);
//# sourceMappingURL=main.99c24294.chunk.js.map